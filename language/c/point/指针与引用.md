# 指针与引用
指针是c系语言的特色。指针是c++提供的一种颇具特色的数据类型，允许直接获取和操纵数据地址，实现动态存储分配。

指针是c和c++的精华所在，也是c和c++中一个十分重要的概念。一个数据对象的内存地址称为该数据对象的指针。指针可以表示各种数据对象，如简单变量、数组、数组元素、结构体，甚至函数。换句话说，指针具有不同的类型，可以指向不同的数据存储体。

指针问题，包括常量指针、数组指针、函数指针、this指针、指针传值、指向指针的指针等，这些问题也是各大公司的常备考点。  

### 指针的基本问题

**面试例题1：**指针和引用的差别？

答案：1、非空区别。在任何情况下都不能使用指向空值的引用。2、合法性区别。在使用引用之前不需要测试它的合法性。指针则应该总是被测试，防止其为空。3、可修改区别。指针与引用的另一个重要的区别是指针可以被重新赋值以指向另一个不同的对象。但是引用则总是指向在初始化时被指定的对象，但是指定的对象其内容可以改变。  

**面试例题2：**看下面的程序哪里出错?  

```
#include <iostream>
using namespace std;
int main()
{
    int iv;							//1
    int iv2 = 1024;					//2
    int iv3 = 999;					//3
    int &reiv;						//4
    int &reiv2 = iv;				//5
    int &reiv3 = iv;				//6
    int *pi;						//7
    int *pi = 5;					//8
    pi = &iv3;						//9
    const double di;				//10
    const double maxWage = 10.0;	//11
    const double minWage = 0.5;		
    const double *pc = &maxWage	;	//12
    
    cout << pi;
    return 0;
}
```

答案：4、8、10错误。

### 传递动态内存

**面试试题1：**两个数的交换。

```
#include <iostream>
using namespace std;

void swap(int a, int b)
{
	int temp;
	temp = a;
	a = b;
	b = temp;
}

void swap1(int *a, int *b)
{
	int temp;
	temp = *a;
	*a = *b;
	*b = temp;
}

void swap2(int &a, int &b)
{
	int temp;
	temp = a;
	a = b;
	b = temp;
}

int main()
{
	int a = 1, b = 2;
	swap(a, b);
	cout << a << " " << b << endl;
	swap1(&a, &b);
	cout << a << " " << b << endl;
	swap2(a, b);
	cout << a << " " << b << endl;
}
```

**面试例题2：**下面的测试程序会有什么结果？

```
#include <iostream>

void getMemory(char *p, int num)
{
	p = (char *)malloc(sizeof(char) * num);
}

int main()
{
	char *str = NULL;
	getMemory(str, 10);
	strcpy(str, "hello");
	return 0;
}
```

答案：程序崩溃。函数不能传递动态内存，str一直是NULL。毛病出在函数getMemory中。函数中*p实际上是主函数中str的一个副本，编译器总是要为函数的每个参数制作临时副本。在本例中，p申请了新的内存，只是把p所指向的内存地址改变了，但是str丝毫未变。因为函数没有返回值，因此str并不指向p所申请的那段内存。所以函数并不能输出任何东西。事实上，每执行一次函数就会申请一块内存，但申请的内存却不能有效释放，结果是内存一直被独占，最终导致内存泄漏。  
如果一定要用指针参数去申请内存，那么应该采用指向指针的指针，传str的地址给函数。代码修改如下：

```
#include <iostream>
using namespace std;

void getMemory(char **p, int num)
{
	*p = (char *)malloc(sizeof(char) * num);
}

int main()
{
	char *str = NULL;
	getMemory(&str, 10);
	strcpy(str, "hello");
	cout << *str << endl;
	cout << str << endl;
	cout << &str << endl;
	return 0;
}
```

### 指针数组和数组指针

**面试例题1：**下面的程序的输出是什么？

```
#include <iostream>
#include <stdio.h>
using namespace std;

int main()
{
	int v[2][10] = {{1,2,3,4,5,6,7,8,9,10},
					{11,12,13,14,15,16,17,18,19,20}};
	int (*a)[10] = v;
	
	cout << **a << endl;
	cout << **(a+1) << endl;
	cout << *(*a+1) << endl;
	cout << *(a[0]+1) << endl;
	cout << *(a[1]) << endl;
	return 0;
}
```

答案：结果是 1 11 2 2 11。

**面试例题2：**









